function IF = QfitSWC(ut)

U{1} = [1.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i
0.00000000000000 + 0.00000000000000i	0.998750260394966 - 0.0499791692706783i	0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i
0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i	0.995201841970541 - 0.0978432099761774i	0.00000000000000 + 0.00000000000000i
0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i	0.00000000000000 + 0.00000000000000i	0.989649903525112 - 0.143502851723363i];

U{2} = [0.996920815422110 + 1.73497674291515e-05i	-0.00154493362268643 - 0.0782787158602358i	-0.00434463823045464 + 0.000168690201966436i	1.12880630500611e-05 + 0.000197066777413570i
-0.00236663290179480 - 0.0782581831203627i	0.989534519196659 - 0.0495021190192291i	-0.00760426859275276 - 0.110120357918078i	-0.00750217347080849 + 0.000656215383171274i
-0.00434024763190423 + 0.000258047021449941i	-0.00871370529327599 - 0.110038127341243i	0.979900081749557 - 0.0963241373281104i	-0.0156882785155041 - 0.134417803158467i
1.72403751782980e-05 + 0.000196635461695137i	-0.00748776144740571 + 0.000804148007893866i	-0.0169858023779546 - 0.134260010450649i	0.980510462936710 - 0.142225918857145i];

G = [0 1; -1 0];

NN = length(ut);
N = size(U{1},1);
N0 = size(G,1);
Uf = eye(N);

for k = 1:NN
    if ut(k) <= 0
        Uf = (U{1}^abs(ut(k)))*Uf;
    else 
        Uf = (U{2}^ut(k))*Uf; 
    end
end
%IF = 1-abs(trace(G'*Uf(1:N0,1:N0)))^2/4;
IF = immse(G, Uf(1:N0,1:N0));
end

